<div class="suppliers-container">
  <div class="supplier-card" *ngFor="let supplier of suppliers">
    <div class="card">
      <!-- Acciones -->
      <div class="card-actions">
        <button mat-icon-button *ngIf="!supplier.editing" class="yellow-btn" (click)="edit(supplier)">
          <mat-icon>create</mat-icon>
        </button>
        <button mat-icon-button *ngIf="!supplier.editing" color="warn" (click)="delete(supplier)">
          <mat-icon>delete</mat-icon>
        </button>
        <button mat-icon-button *ngIf="supplier.editing" color="primary" (click)="save(supplier)"
          [disabled]="!supplier.editCuit || !supplier.editBusinessName || !supplier.editEmail || !supplier.editPhone">
          <mat-icon>save_alt</mat-icon>
        </button>
        <button mat-icon-button *ngIf="supplier.editing" color="warn" (click)="cancelEdit(supplier)">
          <mat-icon>cancel</mat-icon>
        </button>
      </div>

      <div class="card-body">
        <!-- Editable -->
        <div *ngIf="supplier.editing" class="edit-mode">
          <div class="form-group">
            <label>CUIT</label>
            <input type="text" class="form-control" [(ngModel)]="supplier.editCuit" required pattern="^[0-9]{11}$"
                   #cuitInput="ngModel" [ngClass]="{ 'is-invalid': cuitInput.invalid && cuitInput.touched }"/>
            <small *ngIf="cuitInput.invalid && cuitInput.touched" class="error-msg">
              <span *ngIf="cuitInput.errors?.['required']">El CUIT es obligatorio.</span>
              <span *ngIf="cuitInput.errors?.['pattern']">Debe tener exactamente 11 números.</span>
            </small>
          </div>

          <div class="form-group">
            <label>Nombre</label>
            <input type="text" class="form-control" [(ngModel)]="supplier.editBusinessName" required
                   #nameInput="ngModel" [ngClass]="{ 'is-invalid': nameInput.invalid && nameInput.touched }"/>
            <small *ngIf="nameInput.invalid && nameInput.touched" class="error-msg">El nombre es obligatorio.</small>
          </div>

          <div class="form-group">
            <label>Email</label>
            <input type="email" class="form-control" [(ngModel)]="supplier.editEmail" required
                   #emailInput="ngModel" [ngClass]="{ 'is-invalid': emailInput.invalid && emailInput.touched }"/>
            <small *ngIf="emailInput.invalid && emailInput.touched" class="error-msg">
              <span *ngIf="emailInput.errors?.['required']">El email es obligatorio.</span>
              <span *ngIf="emailInput.errors?.['email']">Formato inválido.</span>
            </small>
          </div>

          <div class="form-group">
            <label>Teléfono</label>
            <input type="text" class="form-control" [(ngModel)]="supplier.editPhone" required
                   #phoneInput="ngModel" [ngClass]="{ 'is-invalid': phoneInput.invalid && phoneInput.touched }"/>
            <small *ngIf="phoneInput.invalid && phoneInput.touched" class="error-msg">El teléfono es obligatorio.</small>
          </div>
        </div>

        <!-- No editable -->
        <div *ngIf="!supplier.editing">
          <h3 class="card-text">CUIT</h3>
          <p class="truncate">{{ supplier.cuit }}</p>

          <h3 class="card-text">Nombre</h3>
          <p class="truncate">{{ supplier.businessName }}</p>

          <h3 class="card-text">Email</h3>
          <p class="truncate">{{ supplier.email }}</p>

          <h3 class="card-text">Teléfono</h3>
          <p>{{ supplier.phone }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
