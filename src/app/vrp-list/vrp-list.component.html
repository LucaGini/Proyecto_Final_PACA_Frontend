<div *ngIf="ordersInDistribution.length > 0" class="vrp-container">
  <div *ngIf="selectedOrderNumbers.size > 0" class="mb-3 p-2 bg-light border rounded">
    <p>{{ selectedOrderNumbers.size }} órdenes seleccionadas</p>
      <button (click)="updateSelectedOrders('completed')" class="btn-completed">
        Completadas
      </button>
      <button (click)="updateSelectedOrders('rescheduled')" class="btn-rescheduled">
        Reprogramadas
      </button>
  </div>

  <div *ngFor="let province of getProvinces()" class="card mb-3">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h4 class="mb-0">{{ province | titlecase }}</h4>
      <span class="badge bg-secondary">
        {{ routesByProvince[province].length || 0 }} órdenes
      </span>
    </div>

    <div class="card-body p-0">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th></th>
            <th>Orden</th>
            <th>Cliente</th>
            <th>Total</th>
            <th>Dirección</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of routesByProvince[province]; trackBy: trackByOrderId"
              [class.table-primary]="isSelected(order)">
            <td>
              <input
                type="checkbox"
                class="form-check-input custom-checkbox"
                [checked]="isSelected(order)"
                (change)="toggleSelection(order, $event)"/>
            </td>

            <td class="order-number">#{{ order?.orderNumber }}</td>
            <td>{{ order?.user.firstName }} {{ order?.user.lastName }}</td>
            <td class="text-success">${{ order?.total }}</td>
            <td class="address">{{ order?.user?.street }} {{ order?.user?.streetNumber }}, {{ order?.user?.city?.name }}</td>

            <td>
              <span
                class="badge"
                [ngClass]="{
                  'bg-info text-dark': order?.status === 'in distribution',
                  'bg-success': order?.status === 'completed',
                  'bg-warning text-dark': order?.status === 'rescheduled',
                  'bg-secondary': order?.status !== 'in distribution' && order?.status !== 'completed' && order?.status !== 'rescheduled'
                }">
                {{ order?.status }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Mensaje cuando no hay órdenes en distribución -->
<ng-container *ngIf="!ordersInDistribution || (ordersInDistribution && getProvinces().length === 0)">
  <div class="no-orders-message">
    <mat-icon>receipt_long_off</mat-icon>
    <h3>No hay órdenes disponibles</h3>
    <p *ngIf="ordersInDistribution && getProvinces().length === 0">
      No se encontraron órdenes para mostrar. Intenta revisar filtros o carga nuevas órdenes.
    </p>
    <p *ngIf="!ordersInDistribution || ordersInDistribution.length === 0">
      Aún no se han cargado órdenes. Por favor, genera o asigna órdenes para poder verlas aquí.
    </p>
  </div>
</ng-container>
